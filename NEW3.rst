############################################################################################
NEW3. 2 и больше объявления закупок методом прямого заключения договора для одного предмета закупки по причине дозакупок товаров, услуг, работ до 5% от стоимости предыдущего конкурса.
############################################################################################

***************
Суть индикатора
***************

Индикатор исследует случаи, когда закупающая организация превышает дозволенную границу в 5% для дозакупки товаров/услуг/работ используя метод прямого заключения договора.

****
Риск
****
Избегание проведения конкурсных закупок. 

*******************************
Нарушение норм/принципов закона
*******************************

Статья 

***********************************
Основание для разработки индикатора
***********************************

*******************************
Методология расчета индикатора.
*******************************

Уровень расчета
===============
Индикатор расcчитывается на уровне *конкурса*.

Источники данных для расчета
============================

Для расчета индикатора используются следующие источники данных:

- API системы государственных закупок в OCDS формате
- Транзакционная переменнная :ref:`tv_badDataQuality`
- Аналитическая таблица :ref:`tbl_additionalProcurements`

Типы конкурсов
==============

Индикатор рассчитывается для следующих типов конкурсов:

- метод прямого заключения договора.


Статусы конкурсов
-----------------

Индикатор расчитывается для процедур, которые:

- находятся в статусе ``published``


Частота расчета
===============

Если выполнены все условия для активации расчета индикатора, он рассчитывается один раз.

Поля для расчета
================

Для расчета индикатора используются следующие поля API модуля системы гос. закупок:

- ``data.tender.procurementMethodRationale``
- ``data.tender.procurementMethodDetails``
- ``data.tender.tenderNumber``
- ``data.relatedProcesses.tenderNumber``
- ``data.parties.id``
- ``data.parties.roles``

Для расчета используются следующие транзакционные переменные:

- :ref:`tv_badDataQuality`

Для расчета используется следующая аналитическая таблица:

- :ref:`tbl_additionalProcurements`

Качество данных
===============

Если значение переменной :ref:`tv_badDataQuality` для данной процедуры равно ``true``, индикатор принимает значение ``-1`` и расчет его не производится.

Формула расчета
===============

1. Выбираем только закупки, у которых ``data.tender.procurementMethodRationale='additionalProcurement5'``.

2. Выбираем номер конкурса, на который ссылается закупающая организация ``data.relatedProcesses.tenderNumber``.

3. Из найденного номера удаляем все символы, кроме цифр.

4. В системе госзакупок находим конкурс с таким номером ``data.tender.tenderNumber=data.relatedProcesses.tenderNumber``.

5. Если по номеру конкурс найти не удалось, индикатор принимает значение ``-1``, расчет заканчивается.

6. Если конкурс найден, то смотрим его тип ``data.tender.procurementMethodDetails``. Если ``data.tender.procurementMethodDetails='singleSource'``, индикатор принимает значение ``-1``, расчет заканчивается.

7. Выбиреам идентификатор закупающей организации - ``data.parties.id``, где ``data.parties.roles='buyer'``.

8. По идентификатору закупающей организации и номеру из п.2 проводим поиск строк в таблице :ref:`tbl_additionalProcurements`.

9. Если находим соответствующую строку в таблице, индикатор принимает значение ``1``. Если не находим, индикатор принимает значение ``0``.

Факторы, которые влияют на корректное срабатывание индикатора
=============================================================

Индикатор может срабатывать неправильнов случае, когда представитель закупающей организации неправильно ввел номер конкурса, на который ссы.
