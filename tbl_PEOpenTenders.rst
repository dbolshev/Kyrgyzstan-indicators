.. _tbl_PEOpenTenders:

tbl_PEOpenTenders
=================

Данная аналитическая таблица хранит все коды предметов закупок и даты объявления конкурсных процедур для каждой закупающей организации в календарном году.

Данная аналитическая таблица содержит следующую информацию:
 - Идентификатор закупающей организации;
 - Транзакционная переменная :ref:`tv_tenderCPVList`;
 - Дата объявления процедуры закупки
 - Год, для которого расчитана таблица.

Пример того, как может выглядеть таблица:

======================== =========================== ====== =====
Закупающая организация   Транзакционная переменная   Дата   Год
------------------------ --------------------------- ------ -----
Закупающая организация 1 Транзакционная переменная 1 Дата 1 Год 1     
Закупающая организация 1 Транзакционная переменная 2 Дата 2 Год 1
Закупающая организация 1 Транзакционная переменная 3 Дата 3 Год 1
Закупающая организация 2 Транзакционная переменная 1 Дата 1 Год 1
Закупающая организация 2 Транзакционная переменная 2 Дата 2 Год 1
....                     ....                        ...    ...
======================== =========================== ====== =====

****************************
Расчет аналитической таблицы
****************************

****************************
Источники данных для расчета
****************************

Для расчета аналитической таблицы используются следующие источники данных:

- API системы государственных закупок в OCDS формате.
- Транзакционная переменная :ref:`tv_tenderCPVList`

*************************************
Частота расчета аналитической таблицы
*************************************

Аналитическая таблица рассчитывается 1 раз в сутки.

****************
Поля для расчета
****************

- ``data.tender.status``
- ``data.tender.datePublished``
- ``data.parties.roles``
- ``data.parties.identifier.scheme``
- ``data.parties.identifier.id``

***********************
Формула расчета таблицы
***********************
1. Перед расчетом таблица для текущего года очищается. Все таблицы, расчитанные для более ранних годов остаются без изменений.
2. Выбираем только процедуры проводимые одноэтапным методом, упрощенным методом или методом на понижение цены, у которых ``data.tender.status = 'active'``, дата оглашения которых ``data.tender.datePublished`` находится в промежутке от начала текущего календарного года до текущей даты. Проверку качества данных процедур не выполняем.
3. Определяем идентификатор закупающей организации (конкатенация ``data.parties.identifier.scheme`` и ``data.parties.identifier.id``) элемента ``data.parties``, у которого ``data.parties.roles = 'buyer, procuringEntity'``.
4. Из выбранных процедур берем их переменные :ref:`tv_tenderCPVList`. Также берем год, для которого считается таблица.
5. Полученные данные заносим в таблицу.
