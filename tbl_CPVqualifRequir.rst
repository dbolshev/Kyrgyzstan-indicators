.. _tbl_CPVqualifRequir:

tbl_CPVqualifRequir
===================

Данная аналитическая таблица хранит все предметы закупок, которые были успешно приобретены с помощью конкурентных методов закупок и среднее количество квалификационных требований к поставщикам в этих закупках.

Данная аналитическая таблица содержит следующую информацию:
 - Код предмета закупки,
 - среднее количество квалификационных требований.
 
Пример того, как может выглядеть таблица:

==================== ==================
Код предмета закупки Среднее значение
-------------------- ------------------
Код предмета 1       Среднее значение 1
Код предмета 2       Среднее значение 2
Код предмета 3       Среднее значение 3
Код предмета 4       Среднее значение 4
Код предмета 5       Среднее значение 5
...
==================== ==================

****************************
Расчет аналитической таблицы
****************************

****************************
Источники данных для расчета
****************************

Для расчета аналитической таблицы используются следующие источники данных:

- API системы государственных закупок в OCDS формате.

*************************************
Частота расчета аналитической таблицы
*************************************

Аналитическая таблица рассчитывается 1 раз в сутки.

****************
Поля для расчета
****************

- ``date``
- ``data.qualificationRequirements.id``
- ``data.tender.items.classification.scheme``
- ``data.tender.items.classification.id``

***********************
Формула расчета таблицы
***********************

1. Перед расчетом таблица очищается.
2. Выбираем только процедуры, ``data.tender.procurementMethod = 'open'``. Из них выбираем процедуры, у которых ``date`` отстоят на год или менее от даты в поле ``date`` исследуемой процедуры.
3. Выбираем только завершенные процедуры ``data.tender.status = 'complete'``.
4. выбираем все коды предметов закупок (конкатенация ``data.tender.items.classification.scheme`` и ``data.tender.items.classification.id``).
5. Считаем количество квалификационных требований - элементов ``data.qualificationRequirements.id``.
6. Для каждой процедуры всем предметам закупки ставим соответствие количество квалификационных требований.
7. Группируем данные по предметам закупки, усредняя количество квалификационных требований.
8. Полученный результат заносим в таблицу.
